<?xml version="1.0"?>
<layout version="0.1.0">
    <easycredit_components>
        <reference name="before_body_end">
            <block type="core/text" name="easycredit_script" as="easycredit_script">
                <action method="setText">
                    <text><![CDATA[
                        <script type="module" src="https://ratenkauf.easycredit.de/api/resource/webcomponents/v3/easycredit-components/easycredit-components.esm.js"></script>
                        <script nomodule src="https://ratenkauf.easycredit.de/api/resource/webcomponents/v3/easycredit-components/easycredit-components.js"></script>
                    ]]></text>
                </action>
            </block>
        </reference>
    </easycredit_components>

    <adminhtml_sales_order_view>
        <update handle="easycredit_components" />

        <reference name="order_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_view>
    
    <adminhtml_sales_order_invoice_new>
        <update handle="easycredit_components" />
        <reference name="invoice_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_invoice_new>

    <adminhtml_sales_order_invoice_updateqty>
        <update handle="easycredit_components" />
        <reference name="invoice_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_invoice_updateqty>

    <adminhtml_sales_order_invoice_view>
        <update handle="easycredit_components" />
        <reference name="invoice_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_invoice_view>

    <adminhtml_sales_order_creditmemo_new>
        <update handle="easycredit_components" />
        <reference name="creditmemo_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_creditmemo_new>
     
    <adminhtml_sales_order_creditmemo_updateqty>
        <update handle="easycredit_components" />
        <reference name="creditmemo_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit" template="easycredit/sales/order/total.phtml" />
        </reference>
    </adminhtml_sales_order_creditmemo_updateqty>

    <adminhtml_sales_order_creditmemo_view>
        <update handle="easycredit_components" />
        <reference name="creditmemo_totals">
            <block type="adminhtml/sales_order_totals_item" name="easycredit.refunded" template="easycredit/sales/order/refunded.phtml">
                <action method="setDisplayArea"><area>footer</area></action>
            </block>
        </reference>
    </adminhtml_sales_order_creditmemo_view>
</layout>
